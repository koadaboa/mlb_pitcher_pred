2025-03-26 10:12:25,135 - __main__ - INFO - Starting pitcher performance analysis pipeline...
2025-03-26 10:12:25,136 - src.data.db - INFO - Initializing SQLite database...
2025-03-26 10:12:25,137 - src.data.db - INFO - Database initialization complete.
2025-03-26 10:12:25,137 - src.data.fetch - INFO - Loading cached statcast data from data/statcast_pitcher_data.pkl
2025-03-26 10:12:28,326 - src.data.fetch - INFO - Loading cached traditional stats from data/traditional_pitcher_data.pkl
2025-03-26 10:12:28,343 - src.data.db - INFO - Game stats table already populated and force_refresh is False. Skipping.
2025-03-26 10:12:28,343 - src.data.db - INFO - Traditional stats table already populated and force_refresh is False. Skipping.
2025-03-26 10:12:28,343 - src.data.db - INFO - Updating pitcher ID mappings...
2025-03-26 10:12:28,345 - src.data.db - INFO - Current status: 859 pitchers mapped out of 6317 statcast and 1236 traditional
2025-03-26 10:12:35,884 - src.data.db - INFO - Mapped 0 additional pitchers with exact name matches.
2025-03-26 10:12:35,892 - src.data.db - INFO - Mapped 0 additional pitchers with enhanced name matching.
2025-03-26 10:12:35,892 - src.data.db - INFO - Total: 859/6317 pitchers mapped between Statcast and traditional stats.
2025-03-26 10:12:35,895 - src.data.db - INFO - Found 1185 players with multiple entries - merging data...
2025-03-26 10:13:42,637 - __main__ - INFO - Starting pitcher performance analysis pipeline...
2025-03-26 10:13:42,637 - src.data.db - INFO - Initializing SQLite database...
2025-03-26 10:13:42,639 - src.data.db - INFO - Database initialization complete.
2025-03-26 10:13:42,656 - src.data.fetch - INFO - Fetching data from 2019-04-01 to 2019-04-15...
2025-03-26 10:13:52,838 - src.data.fetch - INFO - Fetching data from 2019-04-16 to 2019-04-30...
2025-03-26 10:13:59,709 - src.data.fetch - INFO - Fetching data from 2019-05-01 to 2019-05-15...
2025-03-26 10:14:06,641 - src.data.fetch - INFO - Fetching data from 2019-05-16 to 2019-05-30...
2025-03-26 10:14:13,588 - src.data.fetch - INFO - Fetching data from 2019-05-31 to 2019-06-14...
2025-03-26 10:14:20,479 - src.data.fetch - INFO - Fetching data from 2019-06-15 to 2019-06-29...
2025-03-26 10:14:27,418 - src.data.fetch - INFO - Fetching data from 2019-06-30 to 2019-07-14...
2025-03-26 10:14:35,009 - src.data.fetch - INFO - Fetching data from 2019-07-15 to 2019-07-29...
2025-03-26 10:14:41,962 - src.data.fetch - INFO - Fetching data from 2019-07-30 to 2019-08-13...
2025-03-26 10:14:48,909 - src.data.fetch - INFO - Fetching data from 2019-08-14 to 2019-08-28...
2025-03-26 10:14:55,896 - src.data.fetch - INFO - Fetching data from 2019-08-29 to 2019-09-12...
2025-03-26 10:15:02,861 - src.data.fetch - INFO - Fetching data from 2019-09-13 to 2019-09-27...
2025-03-26 10:15:09,758 - src.data.fetch - INFO - Fetching data from 2019-09-28 to 2019-10-01...
2025-03-26 10:15:16,285 - src.data.fetch - INFO - Collected 716758 rows for season 2019
2025-03-26 10:15:17,399 - src.data.fetch - INFO - Saved 2019 data to data/statcast_pitcher_2019.pkl
2025-03-26 10:15:17,400 - src.data.fetch - INFO - Fetching data from 2021-04-01 to 2021-04-15...
2025-03-26 10:15:24,277 - src.data.fetch - INFO - Fetching data from 2021-04-16 to 2021-04-30...
2025-03-26 10:15:31,170 - src.data.fetch - INFO - Fetching data from 2021-05-01 to 2021-05-15...
2025-03-26 10:15:38,095 - src.data.fetch - INFO - Fetching data from 2021-05-16 to 2021-05-30...
2025-03-26 10:15:44,971 - src.data.fetch - INFO - Fetching data from 2021-05-31 to 2021-06-14...
2025-03-26 10:15:51,879 - src.data.fetch - INFO - Fetching data from 2021-06-15 to 2021-06-29...
2025-03-26 10:15:58,821 - src.data.fetch - INFO - Fetching data from 2021-06-30 to 2021-07-14...
2025-03-26 10:16:06,546 - src.data.fetch - INFO - Fetching data from 2021-07-15 to 2021-07-29...
2025-03-26 10:16:14,222 - src.data.fetch - INFO - Fetching data from 2021-07-30 to 2021-08-13...
2025-03-26 10:16:21,176 - src.data.fetch - INFO - Fetching data from 2021-08-14 to 2021-08-28...
2025-03-26 10:16:28,127 - src.data.fetch - INFO - Fetching data from 2021-08-29 to 2021-09-12...
2025-03-26 10:16:35,032 - src.data.fetch - INFO - Fetching data from 2021-09-13 to 2021-09-27...
2025-03-26 10:16:41,985 - src.data.fetch - INFO - Fetching data from 2021-09-28 to 2021-10-01...
2025-03-26 10:16:47,677 - src.data.fetch - INFO - Collected 701173 rows for season 2021
2025-03-26 10:16:48,969 - src.data.fetch - INFO - Saved 2021 data to data/statcast_pitcher_2021.pkl
2025-03-26 10:16:48,971 - src.data.fetch - INFO - Fetching data from 2022-04-01 to 2022-04-15...
2025-03-26 10:16:55,836 - src.data.fetch - INFO - Fetching data from 2022-04-16 to 2022-04-30...
2025-03-26 10:17:02,720 - src.data.fetch - INFO - Fetching data from 2022-05-01 to 2022-05-15...
2025-03-26 10:17:09,648 - src.data.fetch - INFO - Fetching data from 2022-05-16 to 2022-05-30...
2025-03-26 10:17:16,594 - src.data.fetch - INFO - Fetching data from 2022-05-31 to 2022-06-14...
2025-03-26 10:17:23,561 - src.data.fetch - INFO - Fetching data from 2022-06-15 to 2022-06-29...
2025-03-26 10:17:30,475 - src.data.fetch - INFO - Fetching data from 2022-06-30 to 2022-07-14...
2025-03-26 10:17:37,457 - src.data.fetch - INFO - Fetching data from 2022-07-15 to 2022-07-29...
2025-03-26 10:17:45,576 - src.data.fetch - INFO - Fetching data from 2022-07-30 to 2022-08-13...
2025-03-26 10:17:52,491 - src.data.fetch - INFO - Fetching data from 2022-08-14 to 2022-08-28...
2025-03-26 10:17:59,462 - src.data.fetch - INFO - Fetching data from 2022-08-29 to 2022-09-12...
2025-03-26 10:18:06,417 - src.data.fetch - INFO - Fetching data from 2022-09-13 to 2022-09-27...
2025-03-26 10:18:13,330 - src.data.fetch - INFO - Fetching data from 2022-09-28 to 2022-10-01...
2025-03-26 10:18:19,115 - src.data.fetch - INFO - Collected 705074 rows for season 2022
2025-03-26 10:18:20,436 - src.data.fetch - INFO - Saved 2022 data to data/statcast_pitcher_2022.pkl
2025-03-26 10:18:20,438 - src.data.fetch - INFO - Fetching data from 2023-04-01 to 2023-04-15...
2025-03-26 10:18:27,355 - src.data.fetch - INFO - Fetching data from 2023-04-16 to 2023-04-30...
2025-03-26 10:18:34,319 - src.data.fetch - INFO - Fetching data from 2023-05-01 to 2023-05-15...
2025-03-26 10:18:41,255 - src.data.fetch - INFO - Fetching data from 2023-05-16 to 2023-05-30...
2025-03-26 10:18:48,170 - src.data.fetch - INFO - Fetching data from 2023-05-31 to 2023-06-14...
2025-03-26 10:18:55,126 - src.data.fetch - INFO - Fetching data from 2023-06-15 to 2023-06-29...
2025-03-26 10:19:02,075 - src.data.fetch - INFO - Fetching data from 2023-06-30 to 2023-07-14...
2025-03-26 10:19:09,924 - src.data.fetch - INFO - Fetching data from 2023-07-15 to 2023-07-29...
2025-03-26 10:19:16,851 - src.data.fetch - INFO - Fetching data from 2023-07-30 to 2023-08-13...
2025-03-26 10:19:23,844 - src.data.fetch - INFO - Fetching data from 2023-08-14 to 2023-08-28...
2025-03-26 10:19:30,834 - src.data.fetch - INFO - Fetching data from 2023-08-29 to 2023-09-12...
2025-03-26 10:19:37,781 - src.data.fetch - INFO - Fetching data from 2023-09-13 to 2023-09-27...
2025-03-26 10:19:44,778 - src.data.fetch - INFO - Fetching data from 2023-09-28 to 2023-10-01...
2025-03-26 10:19:50,516 - src.data.fetch - INFO - Collected 711991 rows for season 2023
2025-03-26 10:19:51,770 - src.data.fetch - INFO - Saved 2023 data to data/statcast_pitcher_2023.pkl
2025-03-26 10:19:51,771 - src.data.fetch - INFO - Fetching data from 2024-03-28 to 2024-04-11...
2025-03-26 10:19:58,774 - src.data.fetch - INFO - Fetching data from 2024-04-12 to 2024-04-26...
2025-03-26 10:20:05,756 - src.data.fetch - INFO - Fetching data from 2024-04-27 to 2024-05-11...
2025-03-26 10:20:12,666 - src.data.fetch - INFO - Fetching data from 2024-05-12 to 2024-05-26...
2025-03-26 10:20:19,643 - src.data.fetch - INFO - Fetching data from 2024-05-27 to 2024-06-10...
2025-03-26 10:20:26,614 - src.data.fetch - INFO - Fetching data from 2024-06-11 to 2024-06-25...
2025-03-26 10:20:33,570 - src.data.fetch - INFO - Fetching data from 2024-06-26 to 2024-07-10...
2025-03-26 10:20:40,643 - src.data.fetch - INFO - Fetching data from 2024-07-11 to 2024-07-25...
2025-03-26 10:20:48,493 - src.data.fetch - INFO - Fetching data from 2024-07-26 to 2024-08-09...
2025-03-26 10:20:55,522 - src.data.fetch - INFO - Fetching data from 2024-08-10 to 2024-08-24...
2025-03-26 10:21:02,545 - src.data.fetch - INFO - Fetching data from 2024-08-25 to 2024-09-08...
2025-03-26 10:21:09,569 - src.data.fetch - INFO - Fetching data from 2024-09-09 to 2024-09-23...
2025-03-26 10:21:16,827 - src.data.fetch - INFO - Fetching data from 2024-09-24 to 2024-10-01...
2025-03-26 10:21:23,111 - src.data.fetch - INFO - Collected 709888 rows for season 2024
2025-03-26 10:21:24,361 - src.data.fetch - INFO - Saved 2024 data to data/statcast_pitcher_2024.pkl
2025-03-26 10:21:30,514 - src.data.fetch - INFO - Saved combined statcast data to data/statcast_pitcher_data.pkl
2025-03-26 10:21:30,965 - src.data.fetch - INFO - Fetching traditional pitching stats for 2019...
2025-03-26 10:21:36,042 - src.data.fetch - INFO - Saved 2019 traditional data to data/traditional_pitcher_2019.pkl
2025-03-26 10:21:36,042 - src.data.fetch - INFO - Fetching traditional pitching stats for 2021...
2025-03-26 10:21:41,088 - src.data.fetch - INFO - Saved 2021 traditional data to data/traditional_pitcher_2021.pkl
2025-03-26 10:21:41,088 - src.data.fetch - INFO - Fetching traditional pitching stats for 2022...
2025-03-26 10:21:46,134 - src.data.fetch - INFO - Saved 2022 traditional data to data/traditional_pitcher_2022.pkl
2025-03-26 10:21:46,134 - src.data.fetch - INFO - Fetching traditional pitching stats for 2023...
2025-03-26 10:21:51,179 - src.data.fetch - INFO - Saved 2023 traditional data to data/traditional_pitcher_2023.pkl
2025-03-26 10:21:51,179 - src.data.fetch - INFO - Fetching traditional pitching stats for 2024...
2025-03-26 10:21:56,226 - src.data.fetch - INFO - Saved 2024 traditional data to data/traditional_pitcher_2024.pkl
2025-03-26 10:21:56,229 - src.data.fetch - INFO - Saved combined traditional data to data/traditional_pitcher_data.pkl
2025-03-26 10:21:56,230 - src.data.db - INFO - Processing and storing statcast data...
2025-03-26 10:21:56,413 - src.data.process - INFO - Aggregating statcast data to pitcher-game level...
2025-03-26 10:22:46,537 - src.data.process - WARNING - events_lambda column missing, using zeros for game outcomes
2025-03-26 10:22:46,566 - src.data.process - INFO - Aggregated data to 104453 pitcher-game records
2025-03-26 10:26:53,180 - src.data.db - INFO - Stored 0 pitch mix records.
2025-03-26 10:26:53,181 - src.data.db - INFO - Statcast data stored in database.
2025-03-26 10:26:53,225 - src.data.db - INFO - Processing and storing traditional stats...
2025-03-26 10:26:53,230 - src.data.process - INFO - Processing traditional pitching stats...
2025-03-26 10:26:53,232 - src.data.process - INFO - Processed 247 traditional stat records
2025-03-26 10:26:53,257 - src.data.db - INFO - Traditional stats stored in database. Inserted/updated 247 records.
2025-03-26 10:26:53,257 - src.data.db - INFO - Updating pitcher ID mappings...
2025-03-26 10:26:53,259 - src.data.db - INFO - Current status: 859 pitchers mapped out of 8206 statcast and 1376 traditional
2025-03-26 10:27:06,187 - src.data.db - INFO - Mapped 263 additional pitchers with exact name matches.
2025-03-26 10:27:06,215 - src.data.db - INFO - Mapped 0 additional pitchers with enhanced name matching.
2025-03-26 10:27:06,216 - src.data.db - INFO - Total: 1122/8206 pitchers mapped between Statcast and traditional stats.
2025-03-26 10:27:06,221 - src.data.db - INFO - Found 2026 players with multiple entries - merging data...
2025-03-26 10:28:45,943 - src.features.engineering - INFO - Creating prediction features...
2025-03-26 10:28:45,943 - src.data.db - INFO - Retrieving pitcher data from database...
2025-03-26 10:28:46,513 - src.data.db - INFO - Retrieved 104453 rows of pitcher data.
2025-03-26 10:28:46,528 - src.data.db - INFO - Null value counts in key columns:
team          104453
era           104453
k_per_9       104453
bb_per_9      104453
k_bb_ratio    104453
whip          104453
babip         104453
lob_pct       104453
fip           104453
xfip          104453
war           104453
dtype: int64
2025-03-26 10:32:46,489 - src.features.engineering - INFO - Stored prediction features for 104453 game records.
2025-03-26 10:32:46,559 - src.data.db - INFO - Exporting final dataset to CSV...
2025-03-26 10:32:48,676 - src.data.db - INFO - Exported 104453 rows to data/pitcher_game_level_data.csv
2025-03-26 10:32:48,676 - src.visualization.plots - INFO - Creating visualizations...
2025-03-26 10:32:49,291 - src.visualization.plots - INFO - Created strikeout distribution visualization
2025-03-26 10:32:49,580 - src.visualization.plots - INFO - Created strikeout correlations visualization
2025-03-26 10:32:49,832 - src.visualization.plots - INFO - Created velocity vs strikeouts visualization
2025-03-26 10:32:49,832 - src.visualization.plots - INFO - Using 'era' column for ERA visualizations
2025-03-26 10:32:49,943 - src.visualization.plots - INFO - Created ERA distribution visualization
2025-03-26 10:32:50,009 - src.visualization.plots - WARNING - Column 'era' not found in numeric columns for correlation
2025-03-26 10:32:50,010 - src.visualization.plots - WARNING - Missing required columns for pitch mix visualization
2025-03-26 10:32:50,010 - src.visualization.plots - INFO - Created 4 visualizations in data\visualizations
2025-03-26 10:32:50,010 - __main__ - INFO - Pipeline completed successfully!
2025-03-26 12:04:04,277 - __main__ - INFO - Starting pitcher performance analysis pipeline...
2025-03-26 12:04:04,278 - src.data.db - INFO - Initializing SQLite database...
2025-03-26 12:04:04,279 - src.data.db - INFO - Database initialization complete.
2025-03-26 12:04:04,279 - src.data.fetch - INFO - Loading cached statcast data from data/statcast_pitcher_data.pkl
2025-03-26 12:04:07,092 - src.data.db - INFO - Examining raw statcast data structure...
2025-03-26 12:04:07,092 - src.data.db - INFO - Data shape: (3544884, 114)
2025-03-26 12:04:07,092 - src.data.db - INFO - Available columns: pitch_type, game_date, release_speed, release_pos_x, release_pos_z, player_name, batter, pitcher, events, description, spin_dir, spin_rate_deprecated, break_angle_deprecated, break_length_deprecated, zone, des, game_type, stand, p_throws, home_team...
2025-03-26 12:04:07,238 - src.data.db - INFO - Pitch types: SI, SL, CH, FF, FC, FS, CU, ST, PO, KC, CS, SV, EP, FA, KN, FO, SC...
2025-03-26 12:04:07,342 - src.data.db - INFO - Top 5 pitch types by frequency:
2025-03-26 12:04:07,342 - src.data.db - INFO -   FF: 1192186 (33.6%)
2025-03-26 12:04:07,342 - src.data.db - INFO -   SL: 590974 (16.7%)
2025-03-26 12:04:07,342 - src.data.db - INFO -   SI: 552812 (15.6%)
2025-03-26 12:04:07,342 - src.data.db - INFO -   CH: 384775 (10.9%)
2025-03-26 12:04:07,342 - src.data.db - INFO -   FC: 259749 (7.3%)
2025-03-26 12:04:07,422 - src.data.db - INFO - Event types: strikeout, home_run, field_out, walk, double, force_out, single, fielders_choice, grounded_into_double_play, sac_bunt, hit_by_pitch, fielders_choice_out, sac_fly, field_error, truncated_pa, double_play, triple, strikeout_double_play, catcher_interf, sac_bunt_double_play...
2025-03-26 12:04:07,450 - src.data.db - INFO - release_speed stats: min=30.1, max=105.5, mean=88.91383871420499
2025-03-26 12:04:07,477 - src.data.db - INFO - release_spin_rate stats: min=14, max=3741, mean=2247.422649217467
2025-03-26 12:04:07,503 - src.data.db - INFO - zone stats: min=1, max=14, mean=9.104600440821459
2025-03-26 12:04:07,702 - src.data.db - INFO - Sample player names: Hader, Josh, Brebbia, John, Barnes, Jacob, Leone, Dominic, Guerra, Junior, Mayers, Mike, Claudio, Alex, Webb, Tyler, Wilson, Alex, Hudson, Dakota
2025-03-26 12:04:08,952 - src.data.db - WARNING - Columns with >50% null values:
2025-03-26 12:04:08,952 - src.data.db - WARNING -   spin_dir: 100.0% null
2025-03-26 12:04:08,952 - src.data.db - WARNING -   spin_rate_deprecated: 100.0% null
2025-03-26 12:04:08,952 - src.data.db - WARNING -   break_length_deprecated: 100.0% null
2025-03-26 12:04:08,952 - src.data.db - WARNING -   break_angle_deprecated: 100.0% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   tfs_zulu_deprecated: 100.0% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   tfs_deprecated: 100.0% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   sv_id: 100.0% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   umpire: 100.0% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   on_3b: 90.7% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   swing_length: 86.9% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   bat_speed: 86.9% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   estimated_ba_using_speedangle: 82.8% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   launch_speed_angle: 82.8% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   estimated_slg_using_speedangle: 82.8% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   hc_y: 82.6% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   hc_x: 82.6% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   bb_type: 82.6% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   on_2b: 81.3% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   hit_location: 77.6% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   estimated_woba_using_speedangle: 74.7% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   woba_denom: 74.6% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   events: 74.4% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   iso_value: 74.4% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   babip_value: 74.4% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   woba_value: 74.4% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   on_1b: 69.4% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   hit_distance_sc: 68.1% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   launch_speed: 68.1% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   launch_angle: 68.0% null
2025-03-26 12:04:08,953 - src.data.db - WARNING -   hyper_speed: 67.9% null
2025-03-26 12:04:08,953 - src.data.db - INFO - Data structure examination complete
2025-03-26 12:04:08,954 - src.data.fetch - INFO - Loading cached traditional stats from data/traditional_pitcher_data.pkl
2025-03-26 12:04:08,971 - src.data.db - INFO - Game stats table already populated and force_refresh is False. Skipping.
2025-03-26 12:04:08,971 - src.data.db - INFO - Traditional stats table already populated and force_refresh is False. Skipping.
2025-03-26 12:04:08,971 - src.data.db - INFO - Updating pitcher ID mappings...
2025-03-26 12:04:08,972 - src.data.db - INFO - Current status: 262 pitchers mapped out of 1886 statcast and 402 traditional
2025-03-26 12:06:26,436 - __main__ - INFO - Starting pitcher performance analysis pipeline...
2025-03-26 12:06:26,436 - src.data.db - INFO - Initializing SQLite database...
2025-03-26 12:06:26,459 - src.data.db - INFO - Database initialization complete.
2025-03-26 12:06:26,466 - src.data.fetch - INFO - Fetching data from 2019-04-01 to 2019-04-15...
2025-03-26 12:06:33,487 - src.data.fetch - INFO - Fetching data from 2019-04-16 to 2019-04-30...
2025-03-26 12:06:40,439 - src.data.fetch - INFO - Fetching data from 2019-05-01 to 2019-05-15...
2025-03-26 12:06:47,432 - src.data.fetch - INFO - Fetching data from 2019-05-16 to 2019-05-30...
2025-03-26 12:06:54,447 - src.data.fetch - INFO - Fetching data from 2019-05-31 to 2019-06-14...
2025-03-26 12:07:01,402 - src.data.fetch - INFO - Fetching data from 2019-06-15 to 2019-06-29...
2025-03-26 12:07:08,443 - src.data.fetch - INFO - Fetching data from 2019-06-30 to 2019-07-14...
2025-03-26 12:07:16,484 - src.data.fetch - INFO - Fetching data from 2019-07-15 to 2019-07-29...
2025-03-26 12:07:23,497 - src.data.fetch - INFO - Fetching data from 2019-07-30 to 2019-08-13...
2025-03-26 12:07:30,473 - src.data.fetch - INFO - Fetching data from 2019-08-14 to 2019-08-28...
2025-03-26 12:07:37,502 - src.data.fetch - INFO - Fetching data from 2019-08-29 to 2019-09-12...
2025-03-26 12:07:44,535 - src.data.fetch - INFO - Fetching data from 2019-09-13 to 2019-09-27...
2025-03-26 12:07:51,510 - src.data.fetch - INFO - Fetching data from 2019-09-28 to 2019-10-01...
2025-03-26 12:07:57,889 - src.data.fetch - INFO - Collected 716758 rows for season 2019
2025-03-26 12:07:58,976 - src.data.fetch - INFO - Saved 2019 data to data/statcast_pitcher_2019.pkl
2025-03-26 12:07:58,977 - src.data.fetch - INFO - Fetching data from 2021-04-01 to 2021-04-15...
2025-03-26 12:08:05,924 - src.data.fetch - INFO - Fetching data from 2021-04-16 to 2021-04-30...
2025-03-26 12:08:12,887 - src.data.fetch - INFO - Fetching data from 2021-05-01 to 2021-05-15...
2025-03-26 12:08:19,884 - src.data.fetch - INFO - Fetching data from 2021-05-16 to 2021-05-30...
2025-03-26 12:08:26,822 - src.data.fetch - INFO - Fetching data from 2021-05-31 to 2021-06-14...
2025-03-26 12:08:33,807 - src.data.fetch - INFO - Fetching data from 2021-06-15 to 2021-06-29...
2025-03-26 12:08:40,803 - src.data.fetch - INFO - Fetching data from 2021-06-30 to 2021-07-14...
2025-03-26 12:08:48,448 - src.data.fetch - INFO - Fetching data from 2021-07-15 to 2021-07-29...
2025-03-26 12:08:56,214 - src.data.fetch - INFO - Fetching data from 2021-07-30 to 2021-08-13...
2025-03-26 12:09:03,252 - src.data.fetch - INFO - Fetching data from 2021-08-14 to 2021-08-28...
2025-03-26 12:09:10,229 - src.data.fetch - INFO - Fetching data from 2021-08-29 to 2021-09-12...
2025-03-26 12:09:17,243 - src.data.fetch - INFO - Fetching data from 2021-09-13 to 2021-09-27...
2025-03-26 12:09:24,263 - src.data.fetch - INFO - Fetching data from 2021-09-28 to 2021-10-01...
2025-03-26 12:09:29,965 - src.data.fetch - INFO - Collected 701173 rows for season 2021
2025-03-26 12:09:31,185 - src.data.fetch - INFO - Saved 2021 data to data/statcast_pitcher_2021.pkl
2025-03-26 12:09:31,186 - src.data.fetch - INFO - Fetching data from 2022-04-01 to 2022-04-15...
2025-03-26 12:09:38,135 - src.data.fetch - INFO - Fetching data from 2022-04-16 to 2022-04-30...
2025-03-26 12:09:45,086 - src.data.fetch - INFO - Fetching data from 2022-05-01 to 2022-05-15...
2025-03-26 12:09:52,096 - src.data.fetch - INFO - Fetching data from 2022-05-16 to 2022-05-30...
2025-03-26 12:09:59,115 - src.data.fetch - INFO - Fetching data from 2022-05-31 to 2022-06-14...
2025-03-26 12:10:06,102 - src.data.fetch - INFO - Fetching data from 2022-06-15 to 2022-06-29...
2025-03-26 12:10:13,116 - src.data.fetch - INFO - Fetching data from 2022-06-30 to 2022-07-14...
2025-03-26 12:10:20,171 - src.data.fetch - INFO - Fetching data from 2022-07-15 to 2022-07-29...
2025-03-26 12:10:27,810 - src.data.fetch - INFO - Fetching data from 2022-07-30 to 2022-08-13...
2025-03-26 12:10:34,780 - src.data.fetch - INFO - Fetching data from 2022-08-14 to 2022-08-28...
2025-03-26 12:10:41,806 - src.data.fetch - INFO - Fetching data from 2022-08-29 to 2022-09-12...
2025-03-26 12:10:48,820 - src.data.fetch - INFO - Fetching data from 2022-09-13 to 2022-09-27...
2025-03-26 12:10:55,789 - src.data.fetch - INFO - Fetching data from 2022-09-28 to 2022-10-01...
2025-03-26 12:11:01,529 - src.data.fetch - INFO - Collected 705074 rows for season 2022
2025-03-26 12:11:02,722 - src.data.fetch - INFO - Saved 2022 data to data/statcast_pitcher_2022.pkl
2025-03-26 12:11:02,723 - src.data.fetch - INFO - Fetching data from 2023-04-01 to 2023-04-15...
2025-03-26 12:11:09,721 - src.data.fetch - INFO - Fetching data from 2023-04-16 to 2023-04-30...
2025-03-26 12:11:16,738 - src.data.fetch - INFO - Fetching data from 2023-05-01 to 2023-05-15...
2025-03-26 12:11:23,753 - src.data.fetch - INFO - Fetching data from 2023-05-16 to 2023-05-30...
2025-03-26 12:11:30,750 - src.data.fetch - INFO - Fetching data from 2023-05-31 to 2023-06-14...
2025-03-26 12:11:37,785 - src.data.fetch - INFO - Fetching data from 2023-06-15 to 2023-06-29...
2025-03-26 12:11:44,806 - src.data.fetch - INFO - Fetching data from 2023-06-30 to 2023-07-14...
2025-03-26 12:11:52,454 - src.data.fetch - INFO - Fetching data from 2023-07-15 to 2023-07-29...
2025-03-26 12:11:59,516 - src.data.fetch - INFO - Fetching data from 2023-07-30 to 2023-08-13...
2025-03-26 12:12:06,565 - src.data.fetch - INFO - Fetching data from 2023-08-14 to 2023-08-28...
2025-03-26 12:12:13,571 - src.data.fetch - INFO - Fetching data from 2023-08-29 to 2023-09-12...
2025-03-26 12:12:20,792 - src.data.fetch - INFO - Fetching data from 2023-09-13 to 2023-09-27...
2025-03-26 12:12:27,841 - src.data.fetch - INFO - Fetching data from 2023-09-28 to 2023-10-01...
2025-03-26 12:12:33,548 - src.data.fetch - INFO - Collected 711991 rows for season 2023
2025-03-26 12:12:34,738 - src.data.fetch - INFO - Saved 2023 data to data/statcast_pitcher_2023.pkl
2025-03-26 12:12:34,739 - src.data.fetch - INFO - Fetching data from 2024-03-28 to 2024-04-11...
2025-03-26 12:12:41,794 - src.data.fetch - INFO - Fetching data from 2024-04-12 to 2024-04-26...
2025-03-26 12:12:48,819 - src.data.fetch - INFO - Fetching data from 2024-04-27 to 2024-05-11...
2025-03-26 12:12:55,838 - src.data.fetch - INFO - Fetching data from 2024-05-12 to 2024-05-26...
2025-03-26 12:13:02,881 - src.data.fetch - INFO - Fetching data from 2024-05-27 to 2024-06-10...
2025-03-26 12:13:09,893 - src.data.fetch - INFO - Fetching data from 2024-06-11 to 2024-06-25...
2025-03-26 12:13:16,900 - src.data.fetch - INFO - Fetching data from 2024-06-26 to 2024-07-10...
2025-03-26 12:13:23,966 - src.data.fetch - INFO - Fetching data from 2024-07-11 to 2024-07-25...
2025-03-26 12:13:31,256 - src.data.fetch - INFO - Fetching data from 2024-07-26 to 2024-08-09...
2025-03-26 12:13:38,267 - src.data.fetch - INFO - Fetching data from 2024-08-10 to 2024-08-24...
2025-03-26 12:13:45,331 - src.data.fetch - INFO - Fetching data from 2024-08-25 to 2024-09-08...
2025-03-26 12:13:52,415 - src.data.fetch - INFO - Fetching data from 2024-09-09 to 2024-09-23...
2025-03-26 12:13:59,412 - src.data.fetch - INFO - Fetching data from 2024-09-24 to 2024-10-01...
2025-03-26 12:14:05,685 - src.data.fetch - INFO - Collected 709888 rows for season 2024
2025-03-26 12:14:06,931 - src.data.fetch - INFO - Saved 2024 data to data/statcast_pitcher_2024.pkl
2025-03-26 12:14:12,374 - src.data.fetch - INFO - Saved combined statcast data to data/statcast_pitcher_data.pkl
2025-03-26 12:14:12,821 - src.data.db - INFO - Examining raw statcast data structure...
2025-03-26 12:14:12,821 - src.data.db - INFO - Data shape: (3544884, 114)
2025-03-26 12:14:12,823 - src.data.db - INFO - Available columns: pitch_type, game_date, release_speed, release_pos_x, release_pos_z, player_name, batter, pitcher, events, description, spin_dir, spin_rate_deprecated, break_angle_deprecated, break_length_deprecated, zone, des, game_type, stand, p_throws, home_team...
2025-03-26 12:14:12,985 - src.data.db - INFO - Pitch types: SI, SL, CH, FF, FC, FS, CU, ST, PO, KC, CS, SV, EP, FA, KN, FO, SC...
2025-03-26 12:14:13,090 - src.data.db - INFO - Top 5 pitch types by frequency:
2025-03-26 12:14:13,090 - src.data.db - INFO -   FF: 1192186 (33.6%)
2025-03-26 12:14:13,090 - src.data.db - INFO -   SL: 590974 (16.7%)
2025-03-26 12:14:13,090 - src.data.db - INFO -   SI: 552812 (15.6%)
2025-03-26 12:14:13,090 - src.data.db - INFO -   CH: 384775 (10.9%)
2025-03-26 12:14:13,090 - src.data.db - INFO -   FC: 259749 (7.3%)
2025-03-26 12:14:13,179 - src.data.db - INFO - Event types: strikeout, home_run, field_out, walk, double, force_out, single, fielders_choice, grounded_into_double_play, sac_bunt, hit_by_pitch, fielders_choice_out, sac_fly, field_error, truncated_pa, double_play, triple, strikeout_double_play, catcher_interf, sac_bunt_double_play...
2025-03-26 12:14:13,208 - src.data.db - INFO - release_speed stats: min=30.1, max=105.5, mean=88.91383871420499
2025-03-26 12:14:13,235 - src.data.db - INFO - release_spin_rate stats: min=14, max=3741, mean=2247.422649217467
2025-03-26 12:14:13,263 - src.data.db - INFO - zone stats: min=1, max=14, mean=9.104600440821459
2025-03-26 12:14:13,519 - src.data.db - INFO - Sample player names: Hader, Josh, Brebbia, John, Barnes, Jacob, Leone, Dominic, Guerra, Junior, Mayers, Mike, Claudio, Alex, Webb, Tyler, Wilson, Alex, Hudson, Dakota
2025-03-26 12:14:14,841 - src.data.db - WARNING - Columns with >50% null values:
2025-03-26 12:14:14,841 - src.data.db - WARNING -   spin_dir: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   spin_rate_deprecated: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   break_length_deprecated: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   break_angle_deprecated: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   tfs_zulu_deprecated: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   tfs_deprecated: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   sv_id: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   umpire: 100.0% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   on_3b: 90.7% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   swing_length: 86.9% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   bat_speed: 86.9% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   estimated_ba_using_speedangle: 82.8% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   launch_speed_angle: 82.8% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   estimated_slg_using_speedangle: 82.8% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   hc_y: 82.6% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   hc_x: 82.6% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   bb_type: 82.6% null
2025-03-26 12:14:14,841 - src.data.db - WARNING -   on_2b: 81.3% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   hit_location: 77.6% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   estimated_woba_using_speedangle: 74.7% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   woba_denom: 74.6% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   events: 74.4% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   iso_value: 74.4% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   babip_value: 74.4% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   woba_value: 74.4% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   on_1b: 69.4% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   hit_distance_sc: 68.1% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   launch_speed: 68.1% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   launch_angle: 68.0% null
2025-03-26 12:14:14,842 - src.data.db - WARNING -   hyper_speed: 67.9% null
2025-03-26 12:14:14,842 - src.data.db - INFO - Data structure examination complete
2025-03-26 12:14:14,843 - src.data.fetch - INFO - Fetching traditional pitching stats for 2019...
2025-03-26 12:14:19,891 - src.data.fetch - INFO - Saved 2019 traditional data to data/traditional_pitcher_2019.pkl
2025-03-26 12:14:19,891 - src.data.fetch - INFO - Fetching traditional pitching stats for 2021...
2025-03-26 12:14:24,936 - src.data.fetch - INFO - Saved 2021 traditional data to data/traditional_pitcher_2021.pkl
2025-03-26 12:14:24,936 - src.data.fetch - INFO - Fetching traditional pitching stats for 2022...
2025-03-26 12:14:29,985 - src.data.fetch - INFO - Saved 2022 traditional data to data/traditional_pitcher_2022.pkl
2025-03-26 12:14:29,985 - src.data.fetch - INFO - Fetching traditional pitching stats for 2023...
2025-03-26 12:14:35,029 - src.data.fetch - INFO - Saved 2023 traditional data to data/traditional_pitcher_2023.pkl
2025-03-26 12:14:35,029 - src.data.fetch - INFO - Fetching traditional pitching stats for 2024...
2025-03-26 12:14:40,070 - src.data.fetch - INFO - Saved 2024 traditional data to data/traditional_pitcher_2024.pkl
2025-03-26 12:14:40,074 - src.data.fetch - INFO - Saved combined traditional data to data/traditional_pitcher_data.pkl
2025-03-26 12:14:40,076 - src.data.db - INFO - Processing and storing statcast data...
2025-03-26 12:14:40,076 - src.data.process - INFO - Aggregating statcast data to pitcher-game level...
2025-03-26 12:14:40,076 - src.data.process - INFO - Input data shape: (3544884, 114)
2025-03-26 12:14:40,076 - src.data.process - INFO - Available columns: pitch_type, game_date, release_speed, release_pos_x, release_pos_z, player_name, batter, pitcher, events, description...
2025-03-26 12:14:41,540 - src.data.process - INFO - Unique pitchers: 1889
2025-03-26 12:14:41,632 - src.data.process - INFO - Unique games: 12056
2025-03-26 12:14:41,929 - src.data.process - INFO - Unique pitcher-game combinations: 104453
2025-03-26 12:14:41,929 - src.data.process - INFO - Pitch type column found - extracting pitch mix data
2025-03-26 12:16:22,294 - src.data.process - ERROR - Error during statcast aggregation: "Column(s) ['pitch_count'] do not exist"
2025-03-26 12:16:22,295 - src.data.process - INFO - Falling back to basic aggregation
2025-03-26 12:16:22,295 - src.data.process - INFO - Found outcome data in column: events
2025-03-26 12:16:45,074 - src.data.process - INFO - Found 17 unique pitch types: CH, CS, CU, EP, FA, FC, FF, FO, FS, KC, KN, PO, SC, SI, SL, ST, SV
2025-03-26 12:16:54,244 - src.data.process - INFO - Aggregated data to 104453 pitcher-game records with 30 columns
2025-03-27 13:48:53,255 - __main__ - INFO - Initializing database structure...
2025-03-27 13:48:53,255 - src.data.db - INFO - Initializing SQLite database...
2025-03-27 13:48:53,283 - src.data.db - INFO - Database initialization complete.
2025-03-27 13:48:53,283 - __main__ - INFO - Fetching and storing data...
2025-03-27 13:48:53,284 - src.data.db - INFO - Initializing SQLite database...
2025-03-27 13:48:53,285 - src.data.db - INFO - Database initialization complete.
2025-03-27 13:48:53,285 - src.scripts.data_aquisition - INFO - Fetching Statcast data...
2025-03-27 13:48:53,291 - src.data.fetch - INFO - Fetching data from 2019-04-01 to 2019-04-15...
2025-03-27 13:49:00,493 - src.data.fetch - INFO - Fetching data from 2019-04-16 to 2019-04-30...
2025-03-27 13:49:07,669 - src.data.fetch - INFO - Fetching data from 2019-05-01 to 2019-05-15...
2025-03-27 13:49:14,851 - src.data.fetch - INFO - Fetching data from 2019-05-16 to 2019-05-30...
2025-03-27 13:49:22,058 - src.data.fetch - INFO - Fetching data from 2019-05-31 to 2019-06-14...
2025-03-27 13:49:29,281 - src.data.fetch - INFO - Fetching data from 2019-06-15 to 2019-06-29...
2025-03-27 13:49:36,477 - src.data.fetch - INFO - Fetching data from 2019-06-30 to 2019-07-14...
2025-03-27 13:49:43,781 - src.data.fetch - INFO - Fetching data from 2019-07-15 to 2019-07-29...
2025-03-27 13:49:51,003 - src.data.fetch - INFO - Fetching data from 2019-07-30 to 2019-08-13...
2025-03-27 13:49:58,234 - src.data.fetch - INFO - Fetching data from 2019-08-14 to 2019-08-28...
2025-03-27 13:50:05,471 - src.data.fetch - INFO - Fetching data from 2019-08-29 to 2019-09-12...
2025-03-27 13:50:12,720 - src.data.fetch - INFO - Fetching data from 2019-09-13 to 2019-09-27...
2025-03-27 13:50:19,905 - src.data.fetch - INFO - Fetching data from 2019-09-28 to 2019-10-01...
2025-03-27 13:50:25,777 - src.data.fetch - INFO - Collected 716758 rows for season 2019
2025-03-27 13:50:26,813 - src.data.fetch - INFO - Saved 2019 data to data/statcast_pitcher_2019.pkl
2025-03-27 13:50:26,814 - src.data.fetch - INFO - Fetching data from 2021-04-01 to 2021-04-15...
2025-03-27 13:50:33,973 - src.data.fetch - INFO - Fetching data from 2021-04-16 to 2021-04-30...
2025-03-27 13:50:41,137 - src.data.fetch - INFO - Fetching data from 2021-05-01 to 2021-05-15...
2025-03-27 13:50:48,322 - src.data.fetch - INFO - Fetching data from 2021-05-16 to 2021-05-30...
2025-03-27 13:50:55,461 - src.data.fetch - INFO - Fetching data from 2021-05-31 to 2021-06-14...
2025-03-27 13:51:02,630 - src.data.fetch - INFO - Fetching data from 2021-06-15 to 2021-06-29...
2025-03-27 13:51:09,817 - src.data.fetch - INFO - Fetching data from 2021-06-30 to 2021-07-14...
2025-03-27 13:51:17,115 - src.data.fetch - INFO - Fetching data from 2021-07-15 to 2021-07-29...
2025-03-27 13:51:24,469 - src.data.fetch - INFO - Fetching data from 2021-07-30 to 2021-08-13...
2025-03-27 13:51:31,674 - src.data.fetch - INFO - Fetching data from 2021-08-14 to 2021-08-28...
2025-03-27 13:51:38,916 - src.data.fetch - INFO - Fetching data from 2021-08-29 to 2021-09-12...
2025-03-27 13:51:46,091 - src.data.fetch - INFO - Fetching data from 2021-09-13 to 2021-09-27...
2025-03-27 13:51:53,296 - src.data.fetch - INFO - Fetching data from 2021-09-28 to 2021-10-01...
2025-03-27 13:51:59,051 - src.data.fetch - INFO - Collected 701173 rows for season 2021
2025-03-27 13:52:00,133 - src.data.fetch - INFO - Saved 2021 data to data/statcast_pitcher_2021.pkl
2025-03-27 13:52:00,134 - src.data.fetch - INFO - Fetching data from 2022-04-01 to 2022-04-15...
2025-03-27 13:52:07,277 - src.data.fetch - INFO - Fetching data from 2022-04-16 to 2022-04-30...
2025-03-27 13:52:14,466 - src.data.fetch - INFO - Fetching data from 2022-05-01 to 2022-05-15...
2025-03-27 13:52:21,617 - src.data.fetch - INFO - Fetching data from 2022-05-16 to 2022-05-30...
2025-03-27 13:52:28,825 - src.data.fetch - INFO - Fetching data from 2022-05-31 to 2022-06-14...
2025-03-27 13:52:36,061 - src.data.fetch - INFO - Fetching data from 2022-06-15 to 2022-06-29...
2025-03-27 13:52:43,240 - src.data.fetch - INFO - Fetching data from 2022-06-30 to 2022-07-14...
2025-03-27 13:52:50,470 - src.data.fetch - INFO - Fetching data from 2022-07-15 to 2022-07-29...
2025-03-27 13:52:57,782 - src.data.fetch - INFO - Fetching data from 2022-07-30 to 2022-08-13...
2025-03-27 13:53:04,956 - src.data.fetch - INFO - Fetching data from 2022-08-14 to 2022-08-28...
2025-03-27 13:53:12,173 - src.data.fetch - INFO - Fetching data from 2022-08-29 to 2022-09-12...
2025-03-27 13:53:19,379 - src.data.fetch - INFO - Fetching data from 2022-09-13 to 2022-09-27...
2025-03-27 13:53:26,554 - src.data.fetch - INFO - Fetching data from 2022-09-28 to 2022-10-01...
2025-03-27 13:53:32,321 - src.data.fetch - INFO - Collected 705074 rows for season 2022
2025-03-27 13:53:33,443 - src.data.fetch - INFO - Saved 2022 data to data/statcast_pitcher_2022.pkl
2025-03-27 13:53:33,444 - src.data.fetch - INFO - Fetching data from 2023-04-01 to 2023-04-15...
2025-03-27 13:53:40,674 - src.data.fetch - INFO - Fetching data from 2023-04-16 to 2023-04-30...
2025-03-27 13:53:47,886 - src.data.fetch - INFO - Fetching data from 2023-05-01 to 2023-05-15...
2025-03-27 13:53:55,087 - src.data.fetch - INFO - Fetching data from 2023-05-16 to 2023-05-30...
2025-03-27 13:54:02,266 - src.data.fetch - INFO - Fetching data from 2023-05-31 to 2023-06-14...
2025-03-27 13:54:09,477 - src.data.fetch - INFO - Fetching data from 2023-06-15 to 2023-06-29...
2025-03-27 13:54:16,681 - src.data.fetch - INFO - Fetching data from 2023-06-30 to 2023-07-14...
2025-03-27 13:54:24,062 - src.data.fetch - INFO - Fetching data from 2023-07-15 to 2023-07-29...
2025-03-27 13:54:32,780 - src.data.fetch - INFO - Fetching data from 2023-07-30 to 2023-08-13...
2025-03-27 13:54:40,432 - src.data.fetch - INFO - Fetching data from 2023-08-14 to 2023-08-28...
2025-03-27 13:54:47,712 - src.data.fetch - INFO - Fetching data from 2023-08-29 to 2023-09-12...
2025-03-27 13:54:54,959 - src.data.fetch - INFO - Fetching data from 2023-09-13 to 2023-09-27...
2025-03-27 13:55:02,251 - src.data.fetch - INFO - Fetching data from 2023-09-28 to 2023-10-01...
2025-03-27 13:55:08,012 - src.data.fetch - INFO - Collected 711991 rows for season 2023
2025-03-27 13:55:09,134 - src.data.fetch - INFO - Saved 2023 data to data/statcast_pitcher_2023.pkl
2025-03-27 13:55:09,137 - src.data.fetch - INFO - Fetching data from 2024-03-28 to 2024-04-11...
2025-03-27 13:55:16,407 - src.data.fetch - INFO - Fetching data from 2024-04-12 to 2024-04-26...
2025-03-27 13:55:23,754 - src.data.fetch - INFO - Fetching data from 2024-04-27 to 2024-05-11...
2025-03-27 13:55:30,961 - src.data.fetch - INFO - Fetching data from 2024-05-12 to 2024-05-26...
2025-03-27 13:55:38,228 - src.data.fetch - INFO - Fetching data from 2024-05-27 to 2024-06-10...
2025-03-27 13:55:45,490 - src.data.fetch - INFO - Fetching data from 2024-06-11 to 2024-06-25...
2025-03-27 13:55:52,729 - src.data.fetch - INFO - Fetching data from 2024-06-26 to 2024-07-10...
2025-03-27 13:55:59,967 - src.data.fetch - INFO - Fetching data from 2024-07-11 to 2024-07-25...
2025-03-27 13:56:07,326 - src.data.fetch - INFO - Fetching data from 2024-07-26 to 2024-08-09...
2025-03-27 13:56:14,617 - src.data.fetch - INFO - Fetching data from 2024-08-10 to 2024-08-24...
2025-03-27 13:56:21,863 - src.data.fetch - INFO - Fetching data from 2024-08-25 to 2024-09-08...
2025-03-27 13:56:29,121 - src.data.fetch - INFO - Fetching data from 2024-09-09 to 2024-09-23...
2025-03-27 13:56:36,361 - src.data.fetch - INFO - Fetching data from 2024-09-24 to 2024-10-01...
2025-03-27 13:56:42,669 - src.data.fetch - INFO - Collected 709888 rows for season 2024
2025-03-27 13:56:43,762 - src.data.fetch - INFO - Saved 2024 data to data/statcast_pitcher_2024.pkl
2025-03-27 13:56:48,292 - src.data.fetch - INFO - Saved combined statcast data to data/statcast_pitcher_data.pkl
2025-03-27 13:56:48,499 - src.scripts.data_aquisition - INFO - Fetching traditional pitching stats...
2025-03-27 13:56:48,499 - src.data.fetch - INFO - Fetching traditional pitching stats for 2019...
2025-03-27 13:56:53,571 - src.data.fetch - INFO - Saved 2019 traditional data to data/traditional_pitcher_2019.pkl
2025-03-27 13:56:53,571 - src.data.fetch - INFO - Fetching traditional pitching stats for 2021...
2025-03-27 13:56:58,622 - src.data.fetch - INFO - Saved 2021 traditional data to data/traditional_pitcher_2021.pkl
2025-03-27 13:56:58,622 - src.data.fetch - INFO - Fetching traditional pitching stats for 2022...
2025-03-27 13:57:03,671 - src.data.fetch - INFO - Saved 2022 traditional data to data/traditional_pitcher_2022.pkl
2025-03-27 13:57:03,671 - src.data.fetch - INFO - Fetching traditional pitching stats for 2023...
2025-03-27 13:57:08,722 - src.data.fetch - INFO - Saved 2023 traditional data to data/traditional_pitcher_2023.pkl
2025-03-27 13:57:08,722 - src.data.fetch - INFO - Fetching traditional pitching stats for 2024...
2025-03-27 13:57:13,772 - src.data.fetch - INFO - Saved 2024 traditional data to data/traditional_pitcher_2024.pkl
2025-03-27 13:57:13,776 - src.data.fetch - INFO - Saved combined traditional data to data/traditional_pitcher_data.pkl
2025-03-27 13:57:13,776 - src.scripts.data_aquisition - INFO - Storing raw data in database...
2025-03-27 13:57:13,777 - src.data.db - INFO - Processing and storing statcast data...
2025-03-27 13:57:13,777 - src.data.process - INFO - Aggregating statcast data to pitcher-game level...
2025-03-27 13:57:14,476 - src.data.process - INFO - Grouping by columns: ['pitcher', 'game_id', 'game_date', 'player_name', 'season']
2025-03-27 13:57:25,878 - src.data.process - INFO - Aggregated data to 104453 pitcher-game records with 15 columns
2025-03-27 13:57:26,287 - src.data.db - INFO - Processed 1000 games so far...
2025-03-27 13:57:26,403 - src.data.db - INFO - Processed 2000 games so far...
2025-03-27 13:57:26,543 - src.data.db - INFO - Processed 3000 games so far...
2025-03-27 13:57:26,706 - src.data.db - INFO - Processed 4000 games so far...
2025-03-27 13:57:26,896 - src.data.db - INFO - Processed 5000 games so far...
2025-03-27 13:57:27,107 - src.data.db - INFO - Processed 6000 games so far...
2025-03-27 13:57:27,344 - src.data.db - INFO - Processed 7000 games so far...
2025-03-27 13:57:27,609 - src.data.db - INFO - Processed 8000 games so far...
2025-03-27 13:57:27,895 - src.data.db - INFO - Processed 9000 games so far...
2025-03-27 13:57:28,207 - src.data.db - INFO - Processed 10000 games so far...
2025-03-27 13:57:28,545 - src.data.db - INFO - Processed 11000 games so far...
2025-03-27 13:57:28,901 - src.data.db - INFO - Processed 12000 games so far...
2025-03-27 13:57:29,277 - src.data.db - INFO - Processed 13000 games so far...
2025-03-27 13:57:29,683 - src.data.db - INFO - Processed 14000 games so far...
2025-03-27 13:57:30,109 - src.data.db - INFO - Processed 15000 games so far...
2025-03-27 13:57:30,561 - src.data.db - INFO - Processed 16000 games so far...
2025-03-27 13:57:31,036 - src.data.db - INFO - Processed 17000 games so far...
2025-03-27 13:57:31,531 - src.data.db - INFO - Processed 18000 games so far...
2025-03-27 13:57:32,054 - src.data.db - INFO - Processed 19000 games so far...
2025-03-27 13:57:32,602 - src.data.db - INFO - Processed 20000 games so far...
2025-03-27 13:57:33,187 - src.data.db - INFO - Processed 21000 games so far...
2025-03-27 13:57:33,791 - src.data.db - INFO - Processed 22000 games so far...
2025-03-27 13:57:34,413 - src.data.db - INFO - Processed 23000 games so far...
2025-03-27 13:57:35,057 - src.data.db - INFO - Processed 24000 games so far...
2025-03-27 13:57:35,727 - src.data.db - INFO - Processed 25000 games so far...
2025-03-27 13:57:36,414 - src.data.db - INFO - Processed 26000 games so far...
2025-03-27 13:57:37,131 - src.data.db - INFO - Processed 27000 games so far...
2025-03-27 13:57:37,874 - src.data.db - INFO - Processed 28000 games so far...
2025-03-27 13:57:38,641 - src.data.db - INFO - Processed 29000 games so far...
2025-03-27 13:57:39,927 - src.data.db - INFO - Processed 30000 games so far...
2025-03-27 13:57:41,804 - src.data.db - INFO - Processed 31000 games so far...
2025-03-27 13:57:43,717 - src.data.db - INFO - Processed 32000 games so far...
2025-03-27 13:57:45,688 - src.data.db - INFO - Processed 33000 games so far...
2025-03-27 13:57:47,734 - src.data.db - INFO - Processed 34000 games so far...
2025-03-27 13:57:49,870 - src.data.db - INFO - Processed 35000 games so far...
2025-03-27 13:57:51,994 - src.data.db - INFO - Processed 36000 games so far...
2025-03-27 13:57:54,177 - src.data.db - INFO - Processed 37000 games so far...
2025-03-27 13:57:56,412 - src.data.db - INFO - Processed 38000 games so far...
2025-03-27 13:57:58,688 - src.data.db - INFO - Processed 39000 games so far...
2025-03-27 13:58:01,020 - src.data.db - INFO - Processed 40000 games so far...
2025-03-27 13:58:03,409 - src.data.db - INFO - Processed 41000 games so far...
2025-03-27 13:58:05,854 - src.data.db - INFO - Processed 42000 games so far...
2025-03-27 13:58:08,335 - src.data.db - INFO - Processed 43000 games so far...
2025-03-27 13:58:10,882 - src.data.db - INFO - Processed 44000 games so far...
2025-03-27 13:58:13,502 - src.data.db - INFO - Processed 45000 games so far...
2025-03-27 13:58:16,164 - src.data.db - INFO - Processed 46000 games so far...
2025-03-27 13:58:18,976 - src.data.db - INFO - Processed 47000 games so far...
2025-03-27 13:58:21,829 - src.data.db - INFO - Processed 48000 games so far...
2025-03-27 13:58:24,735 - src.data.db - INFO - Processed 49000 games so far...
2025-03-27 13:58:27,698 - src.data.db - INFO - Processed 50000 games so far...
2025-03-27 13:58:30,772 - src.data.db - INFO - Processed 51000 games so far...
2025-03-27 13:58:34,061 - src.data.db - INFO - Processed 52000 games so far...
2025-03-27 13:58:37,286 - src.data.db - INFO - Processed 53000 games so far...
2025-03-27 13:58:40,838 - src.data.db - INFO - Processed 54000 games so far...
2025-03-27 13:58:44,195 - src.data.db - INFO - Processed 55000 games so far...
2025-03-27 13:58:47,506 - src.data.db - INFO - Processed 56000 games so far...
2025-03-27 13:58:50,878 - src.data.db - INFO - Processed 57000 games so far...
2025-03-27 13:58:54,319 - src.data.db - INFO - Processed 58000 games so far...
2025-03-27 13:58:57,794 - src.data.db - INFO - Processed 59000 games so far...
2025-03-27 13:59:01,323 - src.data.db - INFO - Processed 60000 games so far...
2025-03-27 13:59:04,896 - src.data.db - INFO - Processed 61000 games so far...
2025-03-27 13:59:08,659 - src.data.db - INFO - Processed 62000 games so far...
2025-03-27 13:59:12,452 - src.data.db - INFO - Processed 63000 games so far...
2025-03-27 13:59:16,280 - src.data.db - INFO - Processed 64000 games so far...
2025-03-27 13:59:20,183 - src.data.db - INFO - Processed 65000 games so far...
2025-03-27 13:59:24,114 - src.data.db - INFO - Processed 66000 games so far...
2025-03-27 13:59:28,124 - src.data.db - INFO - Processed 67000 games so far...
2025-03-27 13:59:32,489 - src.data.db - INFO - Processed 68000 games so far...
2025-03-27 13:59:37,024 - src.data.db - INFO - Processed 69000 games so far...
2025-03-27 13:59:41,255 - src.data.db - INFO - Processed 70000 games so far...
2025-03-27 13:59:45,460 - src.data.db - INFO - Processed 71000 games so far...
2025-03-27 13:59:49,712 - src.data.db - INFO - Processed 72000 games so far...
2025-03-27 13:59:53,983 - src.data.db - INFO - Processed 73000 games so far...
2025-03-27 13:59:58,330 - src.data.db - INFO - Processed 74000 games so far...
2025-03-27 14:00:02,731 - src.data.db - INFO - Processed 75000 games so far...
2025-03-27 14:00:07,226 - src.data.db - INFO - Processed 76000 games so far...
2025-03-27 14:00:11,767 - src.data.db - INFO - Processed 77000 games so far...
2025-03-27 14:00:16,437 - src.data.db - INFO - Processed 78000 games so far...
2025-03-27 14:00:21,182 - src.data.db - INFO - Processed 79000 games so far...
2025-03-27 14:00:25,961 - src.data.db - INFO - Processed 80000 games so far...
2025-03-27 14:00:30,819 - src.data.db - INFO - Processed 81000 games so far...
2025-03-27 14:00:35,780 - src.data.db - INFO - Processed 82000 games so far...
2025-03-27 14:00:41,232 - src.data.db - INFO - Processed 83000 games so far...
2025-03-27 14:00:46,269 - src.data.db - INFO - Processed 84000 games so far...
2025-03-27 14:00:51,353 - src.data.db - INFO - Processed 85000 games so far...
2025-03-27 14:00:56,467 - src.data.db - INFO - Processed 86000 games so far...
2025-03-27 14:01:01,695 - src.data.db - INFO - Processed 87000 games so far...
2025-03-27 14:01:06,933 - src.data.db - INFO - Processed 88000 games so far...
2025-03-27 14:01:12,161 - src.data.db - INFO - Processed 89000 games so far...
2025-03-27 14:01:17,556 - src.data.db - INFO - Processed 90000 games so far...
2025-03-27 14:01:22,979 - src.data.db - INFO - Processed 91000 games so far...
2025-03-27 14:01:28,389 - src.data.db - INFO - Processed 92000 games so far...
2025-03-27 14:01:34,075 - src.data.db - INFO - Processed 93000 games so far...
2025-03-27 14:01:39,800 - src.data.db - INFO - Processed 94000 games so far...
2025-03-27 14:01:45,707 - src.data.db - INFO - Processed 95000 games so far...
2025-03-27 14:01:51,815 - src.data.db - INFO - Processed 96000 games so far...
2025-03-27 14:01:58,289 - src.data.db - INFO - Processed 97000 games so far...
2025-03-27 14:02:04,914 - src.data.db - INFO - Processed 98000 games so far...
2025-03-27 14:02:10,862 - src.data.db - INFO - Processed 99000 games so far...
2025-03-27 14:02:16,842 - src.data.db - INFO - Processed 100000 games so far...
2025-03-27 14:02:22,841 - src.data.db - INFO - Processed 101000 games so far...
2025-03-27 14:02:28,971 - src.data.db - INFO - Processed 102000 games so far...
2025-03-27 14:02:35,092 - src.data.db - INFO - Processed 103000 games so far...
2025-03-27 14:02:41,267 - src.data.db - INFO - Processed 104000 games so far...
2025-03-27 14:02:44,077 - src.data.db - INFO - Stored 104453 game records with 0 pitch mix records.
2025-03-27 14:02:44,078 - src.data.db - WARNING - No pitch_pct_* columns found in the data. Check the aggregation process.
2025-03-27 14:02:44,078 - src.data.db - INFO - Statcast data stored in database.
2025-03-27 14:02:44,100 - src.data.db - INFO - Processing and storing traditional stats...
2025-03-27 14:02:44,101 - src.data.process - INFO - Processing traditional pitching stats...
2025-03-27 14:02:44,101 - src.data.process - INFO - Input shape: (247, 393) with columns: IDfg, Season, Name, Team, Age, W, L, WAR, ERA, G...
2025-03-27 14:02:44,105 - src.data.process - INFO - Processed 247 traditional stat records with 394 columns
2025-03-27 14:02:44,106 - src.scripts.data_aquisition - ERROR - Error storing data: name 're' is not defined
2025-03-27 14:02:44,116 - src.scripts.data_aquisition - ERROR - Traceback (most recent call last):
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\scripts\data_aquisition.py", line 46, in fetch_and_store_data
    store_traditional_stats(traditional_data, force_refresh=force_refresh)
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\data\db.py", line 485, in store_traditional_stats
    norm_name = normalize_name(player_name)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\data\process.py", line 267, in normalize_name
    return processed_df
           ^^
NameError: name 're' is not defined

2025-03-27 14:02:44,506 - __main__ - ERROR - Database setup failed during data fetching/storing.
2025-03-27 14:06:07,045 - __main__ - INFO - Initializing database structure...
2025-03-27 14:06:07,045 - src.data.db - INFO - Initializing SQLite database...
2025-03-27 14:06:07,068 - src.data.db - INFO - Database initialization complete.
2025-03-27 14:06:07,068 - __main__ - INFO - Fetching and storing data...
2025-03-27 14:06:07,068 - src.data.db - INFO - Initializing SQLite database...
2025-03-27 14:06:07,069 - src.data.db - INFO - Database initialization complete.
2025-03-27 14:06:07,069 - src.scripts.data_aquisition - INFO - Fetching Statcast data...
2025-03-27 14:06:07,075 - src.data.fetch - INFO - Fetching data from 2019-04-01 to 2019-04-15...
2025-03-27 14:06:14,659 - src.data.fetch - INFO - Fetching data from 2019-04-16 to 2019-04-30...
2025-03-27 14:06:21,908 - src.data.fetch - INFO - Fetching data from 2019-05-01 to 2019-05-15...
2025-03-27 14:06:29,135 - src.data.fetch - INFO - Fetching data from 2019-05-16 to 2019-05-30...
2025-03-27 14:06:36,441 - src.data.fetch - INFO - Fetching data from 2019-05-31 to 2019-06-14...
2025-03-27 14:06:43,711 - src.data.fetch - INFO - Fetching data from 2019-06-15 to 2019-06-29...
2025-03-27 14:06:50,957 - src.data.fetch - INFO - Fetching data from 2019-06-30 to 2019-07-14...
2025-03-27 14:06:58,891 - src.data.fetch - INFO - Fetching data from 2019-07-15 to 2019-07-29...
2025-03-27 14:07:06,163 - src.data.fetch - INFO - Fetching data from 2019-07-30 to 2019-08-13...
2025-03-27 14:07:13,411 - src.data.fetch - INFO - Fetching data from 2019-08-14 to 2019-08-28...
2025-03-27 14:07:20,688 - src.data.fetch - INFO - Fetching data from 2019-08-29 to 2019-09-12...
2025-03-27 14:07:27,974 - src.data.fetch - INFO - Fetching data from 2019-09-13 to 2019-09-27...
2025-03-27 14:07:35,220 - src.data.fetch - INFO - Fetching data from 2019-09-28 to 2019-10-01...
2025-03-27 14:07:41,167 - src.data.fetch - INFO - Collected 716758 rows for season 2019
2025-03-27 14:07:42,231 - src.data.fetch - INFO - Saved 2019 data to data/statcast_pitcher_2019.pkl
2025-03-27 14:07:42,233 - src.data.fetch - INFO - Fetching data from 2021-04-01 to 2021-04-15...
2025-03-27 14:07:49,439 - src.data.fetch - INFO - Fetching data from 2021-04-16 to 2021-04-30...
2025-03-27 14:07:56,648 - src.data.fetch - INFO - Fetching data from 2021-05-01 to 2021-05-15...
2025-03-27 14:08:03,887 - src.data.fetch - INFO - Fetching data from 2021-05-16 to 2021-05-30...
2025-03-27 14:08:11,105 - src.data.fetch - INFO - Fetching data from 2021-05-31 to 2021-06-14...
2025-03-27 14:08:18,334 - src.data.fetch - INFO - Fetching data from 2021-06-15 to 2021-06-29...
2025-03-27 14:08:25,587 - src.data.fetch - INFO - Fetching data from 2021-06-30 to 2021-07-14...
2025-03-27 14:08:33,590 - src.data.fetch - INFO - Fetching data from 2021-07-15 to 2021-07-29...
2025-03-27 14:08:41,702 - src.data.fetch - INFO - Fetching data from 2021-07-30 to 2021-08-13...
2025-03-27 14:08:48,988 - src.data.fetch - INFO - Fetching data from 2021-08-14 to 2021-08-28...
2025-03-27 14:08:56,273 - src.data.fetch - INFO - Fetching data from 2021-08-29 to 2021-09-12...
2025-03-27 14:09:03,510 - src.data.fetch - INFO - Fetching data from 2021-09-13 to 2021-09-27...
2025-03-27 14:09:10,772 - src.data.fetch - INFO - Fetching data from 2021-09-28 to 2021-10-01...
2025-03-27 14:09:16,523 - src.data.fetch - INFO - Collected 701173 rows for season 2021
2025-03-27 14:09:17,693 - src.data.fetch - INFO - Saved 2021 data to data/statcast_pitcher_2021.pkl
2025-03-27 14:09:17,694 - src.data.fetch - INFO - Fetching data from 2022-04-01 to 2022-04-15...
2025-03-27 14:09:24,885 - src.data.fetch - INFO - Fetching data from 2022-04-16 to 2022-04-30...
2025-03-27 14:09:32,154 - src.data.fetch - INFO - Fetching data from 2022-05-01 to 2022-05-15...
2025-03-27 14:09:39,377 - src.data.fetch - INFO - Fetching data from 2022-05-16 to 2022-05-30...
2025-03-27 14:09:46,643 - src.data.fetch - INFO - Fetching data from 2022-05-31 to 2022-06-14...
2025-03-27 14:09:53,938 - src.data.fetch - INFO - Fetching data from 2022-06-15 to 2022-06-29...
2025-03-27 14:10:01,192 - src.data.fetch - INFO - Fetching data from 2022-06-30 to 2022-07-14...
2025-03-27 14:10:08,490 - src.data.fetch - INFO - Fetching data from 2022-07-15 to 2022-07-29...
2025-03-27 14:10:15,875 - src.data.fetch - INFO - Fetching data from 2022-07-30 to 2022-08-13...
2025-03-27 14:10:23,151 - src.data.fetch - INFO - Fetching data from 2022-08-14 to 2022-08-28...
2025-03-27 14:10:30,403 - src.data.fetch - INFO - Fetching data from 2022-08-29 to 2022-09-12...
2025-03-27 14:10:37,665 - src.data.fetch - INFO - Fetching data from 2022-09-13 to 2022-09-27...
2025-03-27 14:10:44,981 - src.data.fetch - INFO - Fetching data from 2022-09-28 to 2022-10-01...
2025-03-27 14:10:50,733 - src.data.fetch - INFO - Collected 705074 rows for season 2022
2025-03-27 14:10:51,859 - src.data.fetch - INFO - Saved 2022 data to data/statcast_pitcher_2022.pkl
2025-03-27 14:10:51,863 - src.data.fetch - INFO - Fetching data from 2023-04-01 to 2023-04-15...
2025-03-27 14:10:59,157 - src.data.fetch - INFO - Fetching data from 2023-04-16 to 2023-04-30...
2025-03-27 14:11:06,445 - src.data.fetch - INFO - Fetching data from 2023-05-01 to 2023-05-15...
2025-03-27 14:11:13,714 - src.data.fetch - INFO - Fetching data from 2023-05-16 to 2023-05-30...
2025-03-27 14:11:21,007 - src.data.fetch - INFO - Fetching data from 2023-05-31 to 2023-06-14...
2025-03-27 14:11:28,230 - src.data.fetch - INFO - Fetching data from 2023-06-15 to 2023-06-29...
2025-03-27 14:11:35,480 - src.data.fetch - INFO - Fetching data from 2023-06-30 to 2023-07-14...
2025-03-27 14:11:42,888 - src.data.fetch - INFO - Fetching data from 2023-07-15 to 2023-07-29...
2025-03-27 14:11:50,144 - src.data.fetch - INFO - Fetching data from 2023-07-30 to 2023-08-13...
2025-03-27 14:11:57,422 - src.data.fetch - INFO - Fetching data from 2023-08-14 to 2023-08-28...
2025-03-27 14:12:04,706 - src.data.fetch - INFO - Fetching data from 2023-08-29 to 2023-09-12...
2025-03-27 14:12:11,974 - src.data.fetch - INFO - Fetching data from 2023-09-13 to 2023-09-27...
2025-03-27 14:12:19,264 - src.data.fetch - INFO - Fetching data from 2023-09-28 to 2023-10-01...
2025-03-27 14:12:25,016 - src.data.fetch - INFO - Collected 711991 rows for season 2023
2025-03-27 14:12:26,145 - src.data.fetch - INFO - Saved 2023 data to data/statcast_pitcher_2023.pkl
2025-03-27 14:12:26,147 - src.data.fetch - INFO - Fetching data from 2024-03-28 to 2024-04-11...
2025-03-27 14:12:33,424 - src.data.fetch - INFO - Fetching data from 2024-04-12 to 2024-04-26...
2025-03-27 14:12:40,729 - src.data.fetch - INFO - Fetching data from 2024-04-27 to 2024-05-11...
2025-03-27 14:12:47,970 - src.data.fetch - INFO - Fetching data from 2024-05-12 to 2024-05-26...
2025-03-27 14:12:55,249 - src.data.fetch - INFO - Fetching data from 2024-05-27 to 2024-06-10...
2025-03-27 14:13:02,514 - src.data.fetch - INFO - Fetching data from 2024-06-11 to 2024-06-25...
2025-03-27 14:13:09,778 - src.data.fetch - INFO - Fetching data from 2024-06-26 to 2024-07-10...
2025-03-27 14:13:17,069 - src.data.fetch - INFO - Fetching data from 2024-07-11 to 2024-07-25...
2025-03-27 14:13:25,114 - src.data.fetch - INFO - Fetching data from 2024-07-26 to 2024-08-09...
2025-03-27 14:13:32,426 - src.data.fetch - INFO - Fetching data from 2024-08-10 to 2024-08-24...
2025-03-27 14:13:39,691 - src.data.fetch - INFO - Fetching data from 2024-08-25 to 2024-09-08...
2025-03-27 14:13:47,004 - src.data.fetch - INFO - Fetching data from 2024-09-09 to 2024-09-23...
2025-03-27 14:13:54,296 - src.data.fetch - INFO - Fetching data from 2024-09-24 to 2024-10-01...
2025-03-27 14:14:00,638 - src.data.fetch - INFO - Collected 709888 rows for season 2024
2025-03-27 14:14:01,775 - src.data.fetch - INFO - Saved 2024 data to data/statcast_pitcher_2024.pkl
2025-03-27 14:14:07,003 - src.data.fetch - INFO - Saved combined statcast data to data/statcast_pitcher_data.pkl
2025-03-27 14:14:07,220 - src.scripts.data_aquisition - INFO - Fetching traditional pitching stats...
2025-03-27 14:14:07,221 - src.data.fetch - INFO - Fetching traditional pitching stats for 2019...
2025-03-27 14:14:12,272 - src.data.fetch - INFO - Saved 2019 traditional data to data/traditional_pitcher_2019.pkl
2025-03-27 14:14:12,272 - src.data.fetch - INFO - Fetching traditional pitching stats for 2021...
2025-03-27 14:14:17,317 - src.data.fetch - INFO - Saved 2021 traditional data to data/traditional_pitcher_2021.pkl
2025-03-27 14:14:17,317 - src.data.fetch - INFO - Fetching traditional pitching stats for 2022...
2025-03-27 14:14:22,363 - src.data.fetch - INFO - Saved 2022 traditional data to data/traditional_pitcher_2022.pkl
2025-03-27 14:14:22,363 - src.data.fetch - INFO - Fetching traditional pitching stats for 2023...
2025-03-27 14:14:27,409 - src.data.fetch - INFO - Saved 2023 traditional data to data/traditional_pitcher_2023.pkl
2025-03-27 14:14:27,409 - src.data.fetch - INFO - Fetching traditional pitching stats for 2024...
2025-03-27 14:14:32,455 - src.data.fetch - INFO - Saved 2024 traditional data to data/traditional_pitcher_2024.pkl
2025-03-27 14:14:32,458 - src.data.fetch - INFO - Saved combined traditional data to data/traditional_pitcher_data.pkl
2025-03-27 14:14:32,459 - src.scripts.data_aquisition - INFO - Storing raw data in database...
2025-03-27 14:14:32,459 - src.data.db - INFO - Processing and storing statcast data...
2025-03-27 14:14:32,459 - src.data.process - INFO - Aggregating statcast data to pitcher-game level...
2025-03-27 14:14:33,614 - src.data.process - INFO - Grouping by columns: ['pitcher', 'game_id', 'game_date', 'player_name', 'season']
2025-03-27 14:14:44,494 - src.data.process - INFO - Aggregated data to 104453 pitcher-game records with 16 columns
2025-03-27 14:14:44,880 - src.data.db - INFO - Processed 1000 games so far...
2025-03-27 14:14:44,993 - src.data.db - INFO - Processed 2000 games so far...
2025-03-27 14:14:45,130 - src.data.db - INFO - Processed 3000 games so far...
2025-03-27 14:14:45,292 - src.data.db - INFO - Processed 4000 games so far...
2025-03-27 14:14:45,479 - src.data.db - INFO - Processed 5000 games so far...
2025-03-27 14:14:45,692 - src.data.db - INFO - Processed 6000 games so far...
2025-03-27 14:14:45,927 - src.data.db - INFO - Processed 7000 games so far...
2025-03-27 14:14:46,186 - src.data.db - INFO - Processed 8000 games so far...
2025-03-27 14:14:46,468 - src.data.db - INFO - Processed 9000 games so far...
2025-03-27 14:14:46,778 - src.data.db - INFO - Processed 10000 games so far...
2025-03-27 14:14:47,111 - src.data.db - INFO - Processed 11000 games so far...
2025-03-27 14:14:47,468 - src.data.db - INFO - Processed 12000 games so far...
2025-03-27 14:14:47,848 - src.data.db - INFO - Processed 13000 games so far...
2025-03-27 14:14:48,249 - src.data.db - INFO - Processed 14000 games so far...
2025-03-27 14:14:48,673 - src.data.db - INFO - Processed 15000 games so far...
2025-03-27 14:14:49,123 - src.data.db - INFO - Processed 16000 games so far...
2025-03-27 14:14:49,596 - src.data.db - INFO - Processed 17000 games so far...
2025-03-27 14:14:50,088 - src.data.db - INFO - Processed 18000 games so far...
2025-03-27 14:14:50,607 - src.data.db - INFO - Processed 19000 games so far...
2025-03-27 14:14:51,160 - src.data.db - INFO - Processed 20000 games so far...
2025-03-27 14:14:51,727 - src.data.db - INFO - Processed 21000 games so far...
2025-03-27 14:14:52,318 - src.data.db - INFO - Processed 22000 games so far...
2025-03-27 14:14:52,935 - src.data.db - INFO - Processed 23000 games so far...
2025-03-27 14:14:53,575 - src.data.db - INFO - Processed 24000 games so far...
2025-03-27 14:14:54,244 - src.data.db - INFO - Processed 25000 games so far...
2025-03-27 14:14:54,933 - src.data.db - INFO - Processed 26000 games so far...
2025-03-27 14:14:55,649 - src.data.db - INFO - Processed 27000 games so far...
2025-03-27 14:14:56,390 - src.data.db - INFO - Processed 28000 games so far...
2025-03-27 14:14:57,156 - src.data.db - INFO - Processed 29000 games so far...
2025-03-27 14:14:58,429 - src.data.db - INFO - Processed 30000 games so far...
2025-03-27 14:15:00,291 - src.data.db - INFO - Processed 31000 games so far...
2025-03-27 14:15:02,204 - src.data.db - INFO - Processed 32000 games so far...
2025-03-27 14:15:04,170 - src.data.db - INFO - Processed 33000 games so far...
2025-03-27 14:15:06,183 - src.data.db - INFO - Processed 34000 games so far...
2025-03-27 14:15:08,248 - src.data.db - INFO - Processed 35000 games so far...
2025-03-27 14:15:10,365 - src.data.db - INFO - Processed 36000 games so far...
2025-03-27 14:15:12,538 - src.data.db - INFO - Processed 37000 games so far...
2025-03-27 14:15:14,762 - src.data.db - INFO - Processed 38000 games so far...
2025-03-27 14:15:17,036 - src.data.db - INFO - Processed 39000 games so far...
2025-03-27 14:15:19,363 - src.data.db - INFO - Processed 40000 games so far...
2025-03-27 14:15:21,743 - src.data.db - INFO - Processed 41000 games so far...
2025-03-27 14:15:24,174 - src.data.db - INFO - Processed 42000 games so far...
2025-03-27 14:15:26,659 - src.data.db - INFO - Processed 43000 games so far...
2025-03-27 14:15:29,192 - src.data.db - INFO - Processed 44000 games so far...
2025-03-27 14:15:31,786 - src.data.db - INFO - Processed 45000 games so far...
2025-03-27 14:15:34,427 - src.data.db - INFO - Processed 46000 games so far...
2025-03-27 14:15:37,253 - src.data.db - INFO - Processed 47000 games so far...
2025-03-27 14:15:40,151 - src.data.db - INFO - Processed 48000 games so far...
2025-03-27 14:15:43,070 - src.data.db - INFO - Processed 49000 games so far...
2025-03-27 14:15:46,031 - src.data.db - INFO - Processed 50000 games so far...
2025-03-27 14:15:49,048 - src.data.db - INFO - Processed 51000 games so far...
2025-03-27 14:15:52,120 - src.data.db - INFO - Processed 52000 games so far...
2025-03-27 14:15:55,231 - src.data.db - INFO - Processed 53000 games so far...
2025-03-27 14:15:58,402 - src.data.db - INFO - Processed 54000 games so far...
2025-03-27 14:16:01,619 - src.data.db - INFO - Processed 55000 games so far...
2025-03-27 14:16:04,889 - src.data.db - INFO - Processed 56000 games so far...
2025-03-27 14:16:08,219 - src.data.db - INFO - Processed 57000 games so far...
2025-03-27 14:16:11,587 - src.data.db - INFO - Processed 58000 games so far...
2025-03-27 14:16:15,018 - src.data.db - INFO - Processed 59000 games so far...
2025-03-27 14:16:18,501 - src.data.db - INFO - Processed 60000 games so far...
2025-03-27 14:16:22,037 - src.data.db - INFO - Processed 61000 games so far...
2025-03-27 14:16:25,734 - src.data.db - INFO - Processed 62000 games so far...
2025-03-27 14:16:29,488 - src.data.db - INFO - Processed 63000 games so far...
2025-03-27 14:16:33,327 - src.data.db - INFO - Processed 64000 games so far...
2025-03-27 14:16:37,193 - src.data.db - INFO - Processed 65000 games so far...
2025-03-27 14:16:41,105 - src.data.db - INFO - Processed 66000 games so far...
2025-03-27 14:16:45,065 - src.data.db - INFO - Processed 67000 games so far...
2025-03-27 14:16:49,081 - src.data.db - INFO - Processed 68000 games so far...
2025-03-27 14:16:53,152 - src.data.db - INFO - Processed 69000 games so far...
2025-03-27 14:16:57,274 - src.data.db - INFO - Processed 70000 games so far...
2025-03-27 14:17:01,458 - src.data.db - INFO - Processed 71000 games so far...
2025-03-27 14:17:05,689 - src.data.db - INFO - Processed 72000 games so far...
2025-03-27 14:17:09,971 - src.data.db - INFO - Processed 73000 games so far...
2025-03-27 14:17:14,301 - src.data.db - INFO - Processed 74000 games so far...
2025-03-27 14:17:18,682 - src.data.db - INFO - Processed 75000 games so far...
2025-03-27 14:17:23,142 - src.data.db - INFO - Processed 76000 games so far...
2025-03-27 14:17:27,659 - src.data.db - INFO - Processed 77000 games so far...
2025-03-27 14:17:32,342 - src.data.db - INFO - Processed 78000 games so far...
2025-03-27 14:17:37,070 - src.data.db - INFO - Processed 79000 games so far...
2025-03-27 14:17:41,865 - src.data.db - INFO - Processed 80000 games so far...
2025-03-27 14:17:46,700 - src.data.db - INFO - Processed 81000 games so far...
2025-03-27 14:17:51,578 - src.data.db - INFO - Processed 82000 games so far...
2025-03-27 14:17:56,503 - src.data.db - INFO - Processed 83000 games so far...
2025-03-27 14:18:01,870 - src.data.db - INFO - Processed 84000 games so far...
2025-03-27 14:18:06,958 - src.data.db - INFO - Processed 85000 games so far...
2025-03-27 14:18:12,055 - src.data.db - INFO - Processed 86000 games so far...
2025-03-27 14:18:17,201 - src.data.db - INFO - Processed 87000 games so far...
2025-03-27 14:18:22,396 - src.data.db - INFO - Processed 88000 games so far...
2025-03-27 14:18:27,635 - src.data.db - INFO - Processed 89000 games so far...
2025-03-27 14:18:32,945 - src.data.db - INFO - Processed 90000 games so far...
2025-03-27 14:18:38,307 - src.data.db - INFO - Processed 91000 games so far...
2025-03-27 14:18:43,713 - src.data.db - INFO - Processed 92000 games so far...
2025-03-27 14:18:49,287 - src.data.db - INFO - Processed 93000 games so far...
2025-03-27 14:18:54,913 - src.data.db - INFO - Processed 94000 games so far...
2025-03-27 14:19:00,589 - src.data.db - INFO - Processed 95000 games so far...
2025-03-27 14:19:06,308 - src.data.db - INFO - Processed 96000 games so far...
2025-03-27 14:19:12,096 - src.data.db - INFO - Processed 97000 games so far...
2025-03-27 14:19:17,930 - src.data.db - INFO - Processed 98000 games so far...
2025-03-27 14:19:23,814 - src.data.db - INFO - Processed 99000 games so far...
2025-03-27 14:19:29,748 - src.data.db - INFO - Processed 100000 games so far...
2025-03-27 14:19:35,734 - src.data.db - INFO - Processed 101000 games so far...
2025-03-27 14:19:41,785 - src.data.db - INFO - Processed 102000 games so far...
2025-03-27 14:19:47,884 - src.data.db - INFO - Processed 103000 games so far...
2025-03-27 14:19:54,027 - src.data.db - INFO - Processed 104000 games so far...
2025-03-27 14:19:56,837 - src.data.db - INFO - Stored 104453 game records with 0 pitch mix records.
2025-03-27 14:19:56,837 - src.data.db - WARNING - No pitch_pct_* columns found in the data. Check the aggregation process.
2025-03-27 14:19:56,837 - src.data.db - INFO - Statcast data stored in database.
2025-03-27 14:19:56,853 - src.data.db - INFO - Processing and storing traditional stats...
2025-03-27 14:19:56,854 - src.data.process - INFO - Processing traditional pitching stats...
2025-03-27 14:19:56,854 - src.data.process - INFO - Input shape: (247, 393) with columns: IDfg, Season, Name, Team, Age, W, L, WAR, ERA, G...
2025-03-27 14:19:56,859 - src.data.process - INFO - Processed 247 traditional stat records with 394 columns
2025-03-27 14:19:56,895 - src.data.db - INFO - Traditional stats stored in database. Inserted/updated 247 records.
2025-03-27 14:19:56,895 - src.data.db - INFO - Updating pitcher ID mappings...
2025-03-27 14:19:56,897 - src.data.db - INFO - Current status: 0 pitchers mapped out of 1889 statcast and 140 traditional
2025-03-27 14:19:56,898 - src.data.db - INFO - Attempting to map 1889 Statcast IDs to FanGraphs IDs
2025-03-27 14:19:56,898 - src.scripts.data_aquisition - ERROR - Error storing data: name 'get_player_id_map' is not defined
2025-03-27 14:19:56,898 - src.scripts.data_aquisition - ERROR - Traceback (most recent call last):
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\scripts\data_aquisition.py", line 49, in fetch_and_store_data
    update_pitcher_mapping()
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\data\db.py", line 635, in update_pitcher_mapping
    mapping_df = get_player_id_map(statcast_ids=statcast_ids)
                 ^^^^^^^^^^^^^^^^^
NameError: name 'get_player_id_map' is not defined

2025-03-27 14:19:57,263 - __main__ - ERROR - Database setup failed during data fetching/storing.
2025-03-27 14:22:30,121 - __main__ - INFO - Initializing database structure...
2025-03-27 14:22:30,121 - src.data.db - INFO - Initializing SQLite database...
2025-03-27 14:22:30,122 - src.data.db - INFO - Database initialization complete.
2025-03-27 14:22:30,122 - __main__ - INFO - Fetching and storing data...
2025-03-27 14:22:30,122 - src.data.db - INFO - Initializing SQLite database...
2025-03-27 14:22:30,123 - src.data.db - INFO - Database initialization complete.
2025-03-27 14:22:30,123 - src.scripts.data_aquisition - INFO - Fetching Statcast data...
2025-03-27 14:22:30,123 - src.data.fetch - INFO - Loading cached statcast data from data/statcast_pitcher_data.pkl
2025-03-27 14:22:32,656 - src.scripts.data_aquisition - INFO - Fetching traditional pitching stats...
2025-03-27 14:22:32,657 - src.data.fetch - INFO - Loading cached traditional stats from data/traditional_pitcher_data.pkl
2025-03-27 14:22:32,665 - src.scripts.data_aquisition - INFO - Storing raw data in database...
2025-03-27 14:22:32,670 - src.data.db - INFO - Game stats table already populated and force_refresh is False. Skipping.
2025-03-27 14:22:32,671 - src.data.db - INFO - Traditional stats table already populated and force_refresh is False. Skipping.
2025-03-27 14:22:32,671 - src.data.db - INFO - Updating pitcher ID mappings...
2025-03-27 14:22:32,671 - src.data.db - INFO - Current status: 0 pitchers mapped out of 1889 statcast and 140 traditional
2025-03-27 14:22:32,672 - src.data.db - INFO - Attempting to map 1889 Statcast IDs to FanGraphs IDs
2025-03-27 14:22:32,673 - src.data.player_mapping - INFO - Mapping 1889 Statcast IDs to FanGraphs IDs
2025-03-27 14:22:32,772 - src.data.player_mapping - INFO - Successfully retrieved 1791 player ID mappings
2025-03-27 14:22:32,925 - src.data.db - INFO - Attempting to map 140 FanGraphs IDs to Statcast IDs
2025-03-27 14:22:32,925 - src.data.player_mapping - INFO - Mapping 140 FanGraphs IDs to Statcast IDs
2025-03-27 14:22:32,928 - src.data.player_mapping - INFO - Successfully retrieved 140 player ID mappings
2025-03-27 14:22:32,945 - src.data.db - INFO - Mapped 1931 additional pitchers using Chadwick Bureau data
2025-03-27 14:22:32,945 - src.data.db - INFO - Total: 1931/1889 pitchers mapped between Statcast and traditional stats
2025-03-27 14:22:32,946 - src.data.db - INFO - Found 4 players with multiple entries - merging data...
2025-03-27 14:22:32,946 - src.scripts.data_aquisition - INFO - Data acquisition completed successfully!
2025-03-27 14:22:33,198 - __main__ - INFO - Database setup completed successfully!
2025-03-27 14:22:33,198 - __main__ - INFO - Processing data for feature engineering...
2025-03-27 14:22:33,198 - src.scripts.data_processing - INFO - Creating prediction features...
2025-03-27 14:22:33,200 - src.features.engineering - INFO - Creating prediction features...
2025-03-27 14:22:33,200 - src.data.db - INFO - Retrieving pitcher data from database...
2025-03-27 14:22:33,793 - src.data.db - WARNING - No pitch mix data found in the database
2025-03-27 14:22:33,793 - src.data.db - INFO - Retrieved 104453 rows of pitcher data with 27 columns
2025-03-27 14:22:33,852 - src.data.db - INFO - Null value counts in key columns:
team          104453
era           104453
k_per_9       104453
bb_per_9      104453
k_bb_ratio    104453
whip          104453
babip         104453
lob_pct       104453
fip           104453
xfip          104453
war           104453
dtype: int64
2025-03-27 14:22:33,869 - __main__ - ERROR - Error setting up database: 'outs'
2025-03-27 14:22:33,924 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\users\kekoa\documents\datascience\mlb_pred\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'outs'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\users\kekoa\documents\datascience\mlb_pred\src\scripts\initialize_db.py", line 56, in setup_database
    process_success = process_data(force_refresh=force_refresh)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\scripts\data_processing.py", line 22, in process_data
    create_prediction_features(force_refresh=force_refresh)
  File "C:\Users\kekoa\Documents\DataScience\mlb_pred\src\features\engineering.py", line 63, in create_prediction_features
    pitcher_data[f'last_{window}_games_outs_avg'] = pitcher_data['outs'].rolling(
                                                    ~~~~~~~~~~~~^^^^^^^^
  File "C:\users\kekoa\documents\datascience\mlb_pred\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\users\kekoa\documents\datascience\mlb_pred\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'outs'

